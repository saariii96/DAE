---
title: "Drug Side Effect Analysis"
output: html_document
---

**1. Introduction**

In recent years, the monitoring and analysis of adverse drug reactions has become increasingly important in pharmacovigilance and clinical research. The accurate identification of associations between drugs and adverse drug reactions (ADRs) is essential to ensure patient safety and support evidence-based medical decision-making (Harpaz et al., 2012).

One of the main challenges in this area is the inconsistent representation of drug names - which often appear under multiple brand names, generic forms or synonyms - making data collection and analysis difficult (Liu et al., 2015; Tiktinsky et al., 2023). Conventional string matching approaches are often insufficient to reliably resolve such variations and can lead to incomplete datasets and overlooked signals.

With the advent of large language models (LLMs), natural language processing (NLP) techniques have shown great potential for resolving semantic ambiguities in biomedical texts. These models, such as OpenAI's GPT, have shown top performance in tasks such as synonym generation, text classification, and linking biomedical concepts (Brown et al., 2020; Sung et al., 2023).

In this project, an LLM (GPT-3.5-Turbo) was used to generate extended synonym lists for a number of the most commonly reported drugs. These synonyms were then used to improve the identification of drugs in the OpenFDA Adverse Event Reporting System (FAERS), from which drug-related adverse event data was extracted. By combining these sources, a more complete and representative adverse drug reaction dataset was created.

This dataset was converted into a binary matrix format, with rows representing drug synonyms and columns representing specific adverse drug reactions. Both exploratory and predictive analyses were performed on this basis. Exploratory steps included the identification of common adverse drug reactions, patterns of co-occurrence of drugs and reactions, and the visualization of these relationships using bar charts, heat maps, bubble plots and clustering.

In addition, a machine learning component was added to the pipeline, where random forest classifiers were trained to predict the presence of individual side effects based on the drug profile. The feature importance scores derived from these models were used to determine which drugs contribute most to the prediction of specific side effects.

To make these findings accessible and actionable, a Shiny web application was developed that allows users to interactively query the drug-side effect matrix, examine patterns, and filter results by individual drug or drug group.

This project had two objectives: (1) to develop a technically innovative system that utilizes state-of-the-art NLP and public health data for improved adverse drug reaction detection, and (2) to create a practical tool that bridges the gap between academic research and real-world healthcare applications. As part of a master's degree program in health sciences, this work reflects both scientific rigor and clinical relevance.

This report describes the entire workflow of the project - from data collection and enrichment to modeling, visualization, and deployment - and concludes with a discussion of potential future extensions and limitations.

**2. Data and Methods**

This study is based on publicly available adverse event data from the [U.S. Food and Drug Administration’s OpenFDA API](https://open.fda.gov/apis/drug/event/) (FDA, n.d.). The dataset contains structured information about adverse events (side effects), medications (both brand and generic names), patient demographics, and event dates reported voluntarily to the FDA by healthcare professionals and the pharmaceutical industry.

#### 2.1 Data Collection and Preprocessing

The initial dataset was queried using the OpenFDA `drug/event` endpoint. A script was implemented in R to retrieve adverse event records related to the top 100 most frequently reported medications. Since drug names are often listed under multiple synonyms or brand names, we extended each entry using **Large Language Model (LLM)** support from OpenAI's GPT-3.5 API to generate additional synonyms per drug (*own implementation*).

Each drug was enriched with side effects through a combined process of:
- LLM-based synonym expansion
- Automated API queries to OpenFDA
- String cleaning and standardization (e.g., splitting multiple side effects separated by semicolons)

The final dataset was transformed into a **binary matrix**, where each row represents a unique drug (or synonym) and each column a potential side effect. The presence of a side effect for a given drug is denoted as `1`.

#### 2.2 Exploratory Data Analysis

Multiple descriptive and visual analysis techniques were applied:
- **Bar plots** to display the most frequent drugs and side effects
- **Heatmaps** of drug–side effect co-occurrence (top 30 × top 30)
- **Bubble plots** showing the strength of drug–side effect relationships
- **Dendrograms** for hierarchical clustering of drug similarity based on their side effect profiles

All analyses were performed in R using packages such as `tidyverse`, `ggplot2`, `plotly`, and `pheatmap`.

#### 2.3 Classification Model

To explore whether side effects could be predicted based on drug profiles, a **Random Forest** classifier was trained for each side effect using the binary matrix as input. Accuracy scores and feature importance were recorded to evaluate which side effects are best predicted and which drugs are most informative per side effect.

This multi-label classification helped identify:
- Which side effects are most predictable
- Which drugs have the strongest predictive power for specific adverse reactions

#### 2.4 Interactive Shiny Application

Finally, a Shiny App was developed to make the results accessible to users. Key features include:
- Searching by drug or synonym
- Viewing all known synonyms of a drug
- Displaying the top 3 most frequent side effects per drug
- Interactive heatmaps and bubble charts using `plotly`
- Data download options (CSV) for further research

The app and all scripts are maintained in a structured GitHub repository.

---

**References**

FDA. (n.d.). *OpenFDA API for drug event reporting*. https://open.fda.gov/apis/drug/event/

Brown, T. B., Mann, B., Ryder, N., Subbiah, M., Kaplan, J., Dhariwal, P., ... & Amodei, D. (2020). Language models are few-shot learners. *Advances in Neural Information Processing Systems, 33*, 1877–1901.

Harpaz, R., DuMouchel, W., Shah, N. H., Madigan, D., Ryan, P., & Friedman, C. (2012). Novel data-mining methodologies for adverse drug event discovery and analysis. *Clinical Pharmacology & Therapeutics, 91*(6), 1010–1021. https://doi.org/10.1038/clpt.2012.50

Liu, S., Shenoy, P., & Xu, H. (2015). Drug name recognition: Approaches and resources. *Information, 6*(4), 790–810. https://doi.org/10.3390/info6040790
